---
title: "Untitled"
author: "Chengxi Zou"
date: '2022-07-31'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

within the document. You can embed an R code chunk like this:

```{r cars}
library(ggplot2)
library(tidyverse)
library(caret)
library(ggplot2)
library(tibble)
library(tree)
library(randomForest)
# rf
rffit <- train(Species ~ Sepal.Length+ Sepal.Width + Petal.Length + Petal.Width, 
               data = iris, 
               method = "rf", 
               trControl = trainControl(method = "cv", number = 5), 
               preProcess = c("center", "scale"),
               tuneGrid = data.frame(mtry = 1:6))
rffit
summary(rffit)


# classification tree
# Split up predictor space into regions, different predictions for each region.
# The goal of classification tree is to classify/predict group membership.
# For a given region, usually use most prevalent class as prediction.
fitTree <- tree(Species ~ Sepal.Length+ Sepal.Width + Petal.Length + Petal.Width, data = iris)
plot(fitTree)
text(fitTree)
summary(fitTree)

fitTree1 <- tree(Species ~ Sepal.Length+ Sepal.Width + Petal.Length + Petal.Width, data = iris, split = "deviance")
plot(fitTree1)
text(fitTree1)
summary(fitTree1)
# classification tree prediction
aa <- predict(fitTree, newdata = data.frame(Sepal.Length=6, Sepal.Width=6,Petal.Length=6,Petal.Width=6))


iris
rffit <- train(Species ~ Sepal.Length+ Sepal.Width + Petal.Length + Petal.Width, data = iris, 
               method = "bag", 
               trControl = trainControl(method = "cv", number = 5), 
               preProcess = c("center", "scale"),
               tuneGrid = data.frame(mtry = 1:6))
rffit
bagfit <- randomForest(Species ~ Sepal.Length+ Sepal.Width + Petal.Length + Petal.Width, data = iris,mty=ncol(iris)-1,
             ntree=200,importance=TRUE)
bagfit
summary(bagfit)

RMSE <- sqrt(mean())




       bagfit <- randomForest(Species ~ .,
                              data = iris,
                              mty=ncol(iris)-1,
                              ntree=200)
       bagfit
data.frame(bagfit$importance)
data.frame(bagfit$confusion)

       plot(bagfit)
       text(bagfit)
varImpPlot(bagfit)

rffit <- train(Species ~ .,
                              data = iris,
               method = "rf", 
               trControl = trainControl(method = "cv", number = 5), 
               preProcess = c("center", "scale"),
               tuneGrid = data.frame(mtry = 1:12))
rffit
rffit$results
rffit$bestTune
plot(rffit)
varImpPlot(rffit)


boostedTfit <- train(Species ~ .,
                              data = iris,
               method = "gbm")
boostedTfit
plot(boostedTfit)

iris
aa
data.frame(aa)

rffit <- randomForest(Species ~ .,data = iris)
rffit$confusion
rffit$importance

library(gbm)
mod_gbm = gbm(Species ~.,
              data = iris,
              distribution = "multinomial",
              cv.folds = 10,
              shrinkage = .01,
              n.minobsinnode = 10,
              n.trees = 200)
 a <- summary(mod_gbm)
 a
 print(mod_gbm)
summary(mod_gbm)
 mod_gbm
 
aaa <- predict(mod_gbm, newdata = data.frame(Sepal.Length=6, Sepal.Width=6,Petal.Length=6,Petal.Width=6))
 aaa
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
